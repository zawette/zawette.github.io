{"pageProps":{"frontmatter":{"title":"Keeping track of my music using NodeJS","date":"10/3/2021","excerpt":"I have a very large collection of music stored locally on my computer, to keep track of it in case my pc dies, i decided to write a  node script.","tags":["node","js"]},"slug":"ListingFiles","content":"\r\n# Keeping track of my music using NodeJS\r\n\r\nI have a very large collection of music stored locally on my computer, to keep track of it in case my pc dies, i decided to write a node script.\r\n\r\n## filtering audio files\r\n\r\nI only have mp3 and wav files, so those are the only extensions i am interested in.\r\n\r\n```js\r\nconst fs = require(\"fs\")\r\n\r\nfs.readdir(\"..\", async (err, files) => {\r\n  const filesTypes = [\"mp3\", \"wav\"]\r\n  const audioFiles = files.filter((file) =>\r\n    filesTypes.some((ft) => file.includes(ft))\r\n  );\r\n}\r\n```\r\n\r\n## getting the metadata\r\n\r\nNext we want to get the title, album, artist name and other metadata, for that purpose, i am using music-metadata npm package.\r\nYou can get it by running this command :\r\n\r\n> npm i music-metadata\r\n\r\n```js\r\nfor (const [index, af] of audioFiles.entries()) {\r\n  const metadata = await mm.parseFile(\"../\" + af);\r\n  const buffer = metadata.common.title\r\n    ? `${metadata.common.artist} - ${metadata.common.title} - ${metadata.common.album}`\r\n    : af;\r\n}\r\n```\r\n\r\n## Final code\r\n\r\nfinally we write the result into a text file,I personally keep the file on my onedrive. and optionally log the progress into the console.\r\nhere's the final code. you can also find it on my [github](https://github.com/zawette/useful-scripts/blob/main/list-music/getMusicZaw.js)\r\n\r\n```js\r\nconst fs = require(\"fs\");\r\nconst mm = require(\"music-metadata\");\r\n\r\nfs.readdir(\"..\", async (err, files) => {\r\n  const filesTypes = [\"mp3\", \"wav\"];\r\n  const audioFiles = files.filter((file) =>\r\n    filesTypes.some((ft) => file.includes(ft))\r\n  );\r\n  var outputFile = fs.createWriteStream(\"musicList.txt\");\r\n  outputFile.write(\"My Music List \\n\");\r\n\r\n  const afLength = audioFiles.length;\r\n  for (const [index, af] of audioFiles.entries()) {\r\n    const metadata = await mm.parseFile(\"../\" + af);\r\n    const buffer = metadata.common.title\r\n      ? `${metadata.common.artist} - ${metadata.common.title} - ${metadata.common.album}`\r\n      : af;\r\n    console.log(`${index} of ${afLength} -  ${buffer}`);\r\n    outputFile.write(buffer + \"\\n\");\r\n  }\r\n  outputFile.end();\r\n});\r\n```\r\n"},"__N_SSG":true}